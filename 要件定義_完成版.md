# やさしいターミナル（GUI版）要件定義・完成版

## 0. 背景と目的
- Claude Code / Codex / Gemini CLI などのAI CLIは、端末での複数行入力や送信操作が扱いづらい。
- 非エンジニアでも安心して使える「日本語中心のターミナルエディタ」を提供する。

## 1. 目的（達成したいこと）
- **Enterは常に改行**できる複数行エディタを提供する。
- **送信は別操作**（Cmd+Enter）で実行し、誤送信を防ぐ。
- 日本語コマンドで操作でき、AI CLIを直感的に使える。

## 2. 非目的（スコープ外）
- AIモデルや課金・認証の実装（既存CLIに委譲）
- フルIDE（LSP/デバッガ/プロジェクト管理）
- OSやシェルの完全代替

## 3. 想定ユーザー
- 非エンジニア（AIへの指示作成が中心）
- エンジニア（AI CLIの複数行入力を高速化したい）

## 4. UX方針（最重要）
- **入力と実行の衝突を避ける**
  - Enter = 改行固定
  - 送信 = Cmd+Enter（Windows/LinuxはCtrl+Enter）
- **日本語中心のコマンド操作**
  - コマンド補完とヘルプを常時表示
  - コマンド変換のプレビューを提示
- **GUI前提**
  - 複数行入力、設定編集、履歴検索を視覚的に提供

## 5. 画面構成（GUI）
- 上部: 出力ログ（AI応答/コマンド実行結果）
- 中部: エディタ（複数行入力、選択/コピー/貼り付け、Undo/Redo）
- 下部: 日本語コマンドバー（補完/履歴/プレビュー）

## 6. 機能要件

### 6.1 入力（Editor）
- 複数行編集（Enter改行）
- 基本編集（移動、選択、コピー/貼り付け、Undo/Redo）
- 送信対象は編集内容全体 or 選択範囲

### 6.2 出力ログ（Log）
- AI CLIのstdout/stderrをストリーム表示
- 重要メッセージのピン留め（Phase 2）
- ログ検索（Phase 2）

### 6.3 日本語コマンドシステム
- 日本語コマンドの正規化（揺れ吸収）
- コマンド補完、説明、プレビュー
- `help` / `?` でヘルプ

#### 基本エイリアス（プリセット）
```yaml
# ファイル操作
ファイル一覧: ls -la
隠しファイル含む一覧: ls -la
今いる場所: pwd
移動: cd
戻る: cd ..
ホームに戻る: cd ~
作成: mkdir
削除: rm
コピー: cp
名前変更: mv
中身を見る: cat
検索: find . -name

# Git操作
状態: git status
差分: git diff
履歴: git log --oneline -20
保存: git add . && git commit -m \"message\"
送信: git push
取得: git pull
ブランチ一覧: git branch -a
切替: git checkout

# AI CLIツール
クロード: claude
コーデックス: codex
ジェミニ: gemini

# システム
クリア: clear
終了: exit
```

#### 自然言語パターン（Phase 2）
```yaml
移動系:
  - "{path}に移動" → "cd {path}"
  - "{path}へ移動" → "cd {path}"
  - "{path}フォルダに移動" → "cd {path}"
作成系:
  - "{name}を作成" → "mkdir {name}"
  - "{name}ファイルを作成" → "touch {name}"
削除系:
  - "{target}を削除" → "rm {target}"
表示系:
  - "{file}の中身" → "cat {file}"
```

### 6.4 AI CLI連携
- `claude` / `codex` / `gemini` を外部コマンドとして実行
- stdinにプロンプトを送信
- stdout/stderrをストリーミング表示
- 実行中断（Phase 2）

### 6.5 履歴・設定
- コマンド履歴、送信履歴の保存/検索
- 日本語エイリアスの編集GUI
- 履歴保存はON/OFF可能

### 6.6 安全性
- 危険コマンド（rm -rf等）の実行前確認（Phase 2）
- AI送信前のプレビュー表示

## 7. 非機能要件
- 起動時間: 2秒以内
- UIがフリーズしない非同期I/O
- macOS優先、将来Windows/Linux対応
- contextIsolation有効、sandbox有効
- 履歴の暗号化は必須ではないが、削除機能は必須

## 8. MVPスコープ
- GUI 3ペイン
- Enter改行 / Cmd+Enter送信
- 日本語コマンドプリセット + 変換プレビュー
- AI CLIストリーム表示
- 設定UI（エイリアス編集）

## 9. 将来拡張
- 自然言語パターンの強化
- 危険コマンド警告
- コマンド生成支援（ローカルLLM）
- TUI版の派生検討（完成後）
